<%- include('../components/header.ejs') %>
<style>
    .picture:hover{
        transform: scale(1.25);
        transition: transform 0.6s ease;
    }
</style>
<div class="container">
    <div class="row">
        <div class="col-sm-12" style="box-shadow: 0px 0px 5px #e3e3e3; padding: 50px;border-radius: 10px;margin-top: 60px">
            <div class="row">
                <div class="col-lg-3">
                    <p style="color: #777777;font-weight: 600">FOR CAR</p>

                    <p>
                        <% if (classify === 'month'){%>
                            <span style="font-weight: 800;color: #0d6efd;font-size: x-large">$<%= price %></span>
                            <span style="color: #ababab"> / per month</span>
                        <%}else{%>
                            <span style="font-weight: 800;color: #0d6efd;font-size: x-large">$<%= price %></span>
                            <span style="color: #ababab"> / <%= time %> day</span>
                        <%}%>

                    </p>
                </div>
                <div class="col-lg-7">
                    <h5 style="color: #0d6efd;font-weight: 900"><%= vehicle.name %></h5>


                    <p style="color: #ababab;font-weight: 600 ; margin-top: 25px">
                        車牌號碼 : <%= vehicle.license_plate %>
                    </p>
                    <p style="color: #ababab ">
                        <svg style="height: 18px;width: 18px;margin-bottom: 3px" xmlns="http://www.w3.org/2000/svg" id="Layer_1" data-name="Layer 1" viewBox="0 0 24 24" width="512" height="512">
                            <path d="M20.9,4.291A5.011,5.011,0,0,0,16.2,1H7.8A5.011,5.011,0,0,0,3.1,4.291L.4,11.718A6.664,6.664,0,0,0,0,14v1a4.979,4.979,0,0,0,2,3.978c0,.008,0,.014,0,.022v2a3,3,0,0,0,6,0V20h8v1a3,3,0,0,0,6,0V19c0-.008,0-.014,0-.022A4.979,4.979,0,0,0,24,15V14a6.654,6.654,0,0,0-.4-2.281ZM4.982,4.975A3.009,3.009,0,0,1,7.8,3h8.4a3.009,3.009,0,0,1,2.82,1.975L21.208,11H2.791ZM6,21a1,1,0,0,1-2,0V19.9A5,5,0,0,0,5,20H6Zm14,0a1,1,0,0,1-2,0V20h1a5,5,0,0,0,1-.1Zm2-6a3,3,0,0,1-3,3H5a3,3,0,0,1-3-3V14a4.659,4.659,0,0,1,.121-1H4v1a1,1,0,0,0,2,0V13H18v1a1,1,0,0,0,2,0V13h1.879A4.652,4.652,0,0,1,22,14Z" fill="#ababab"/>
                        </svg>
                        <span style="margin-right: 15px"><%= vehicle.age %> 年</span>
                        <svg style="height: 18px;width: 18px;margin-bottom: 3px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="512" height="512">
                            <g id="_01_align_center" data-name="01 align center">
                                <path d="M10.931,2.75a3.728,3.728,0,0,0-7.195,0H0v2H3.736a3.728,3.728,0,0,0,7.195,0H24v-2ZM7.333,5.5a1.75,1.75,0,1,1,1.75-1.75A1.753,1.753,0,0,1,7.333,5.5Z" fill="#ababab"/>
                                <path d="M16.667,8.25A3.745,3.745,0,0,0,13.07,11H0v2H13.07a3.727,3.727,0,0,0,7.194,0H24V11H20.264A3.745,3.745,0,0,0,16.667,8.25Zm0,5.5A1.75,1.75,0,1,1,18.417,12,1.752,1.752,0,0,1,16.667,13.75Z" fill="#ababab"/>
                                <path d="M7.333,16.5a3.745,3.745,0,0,0-3.6,2.75H0v2H3.736a3.728,3.728,0,0,0,7.195,0H24v-2H10.931A3.745,3.745,0,0,0,7.333,16.5Zm0,5.5a1.75,1.75,0,1,1,1.75-1.75A1.753,1.753,0,0,1,7.333,22Z" fill="#ababab"/>
                            </g>
                        </svg>
                        <span style="margin-right: 15px"><%= type %></span>
                        <svg style="height: 18px;width: 18px;margin-bottom: 3px" xmlns="http://www.w3.org/2000/svg" id="Layer_1" data-name="Layer 1" viewBox="0 0 24 24">
                            <path d="m22.576,12.52L13.849,3.85c-.842-.835-2.046-1.243-3.221-1.09l-5.803.651L1.707.293C1.316-.098.684-.098.293.293S-.098,1.316.293,1.707l3.118,3.118-.696,6.088c-.091,1.142.323,2.258,1.136,3.062l8.713,8.645c.91.906,2.118,1.404,3.4,1.404h.02c1.29-.005,2.5-.513,3.408-1.431l3.21-3.242c1.87-1.89,1.859-4.955-.025-6.832Zm-1.396,5.426l-3.21,3.242c-.531.537-1.239.834-1.994.837h-.011c-.751,0-1.458-.292-1.992-.823L5.259,12.555c-.394-.39-.594-.93-.554-1.449l.512-4.474,1.857,1.857c-.044.164-.074.334-.074.512,0,1.105.895,2,2,2s2-.895,2-2-.895-2-2-2c-.178,0-.347.031-.512.074l-1.854-1.854,4.226-.474.021-.003c.568-.075,1.151.122,1.559.525l8.726,8.668c1.105,1.102,1.112,2.899.015,4.009Zm-3.974-5.151c-.391-.391-1.023-.391-1.414,0l-3,3c-.391.391-.391,1.023,0,1.414l2.5,2.5c.195.195.451.293.707.293s.512-.098.707-.293l3-3c.391-.391.391-1.023,0-1.414l-2.5-2.5Zm-1.207,4.793l-1.086-1.086,1.586-1.586,1.086,1.086-1.586,1.586Z" fill="#ababab"/>
                        </svg>
                        <span style="margin-right: 15px"><%= brand.name %></span>
                    </p>

                </div>
                <div class="col-lg-2" >
                    <img class="picture" style="width: 100%" src="<%= image %>">
                </div>

            </div>
        </div>
        <div style="margin-top: 50px">
            <h2 style="color: #666666">訂單資訊</h2>
            <div class="row">
                <div class="col-lg-6" style="margin-top: 25px">
                    <h6 style="color: #666666">借車地點</h6>
                    <p style="color: #777777"><%= rental_place.name %>。<%= rental_place.address %></p>

                    <h6 style="color: #666666">還車地點</h6>
                    <p style="color: #777777"><%= return_place.name %>。<%= return_place.address %></p>

                    <h6 style="color: #666666">借車時間</h6>
                    <p style="color: #777777"><%= rental_date %></p>

                    <% if (classify === 'day'){%>
                        <h6 style="color: #666666">還車時間</h6>
                        <p style="color: #777777"><%= return_date %></p>
                    <%} else{ %>
                        <h6 style="color: #666666">訂閱車使用期限為一個月，請在下個月同日準時歸還</h6>
                    <% }%>


                </div>
                <div class="col-lg-6" style="margin-top: 25px">
                    <h6 style="color: #666666">姓名</h6>
                    <p style="color: #777777"><%= user.name %></p>
                    <h6 style="color: #666666">電子郵件信箱</h6>
                    <p style="color: #777777"><%= user.email %></p>
                    <h6 style="color: #666666">身分證字號</h6>
                    <p style="color: #777777"><%= user.identity %></p>
                    <h6 style="color: #666666">手機號碼</h6>
                    <p style="color: #777777"><%= user.phone %></p>
                </div>
            </div>

        </div>
        <div>

            <div class="card" style="padding:40px;margin-top: 25px">
                <h2 style="color: #666666">付款方式</h2>
                <h6 style="color: #666666;margin-top: 25px">選擇付款方式</h6>
                <select onclick="select_payment()" id="payment" class="form-select" aria-label="Default select example">
                    <option selected value="Cash">貨到付款</option>
                    <option value="ATM">ATM 轉帳</option>
                    <option value="Linepay">Line pay 線上付款</option>
                </select>
                <div id="payment_info">
                    <div class="row">
                        <div class="col-md-6">
                            <h6 style="color: #666666;margin-top: 25px">轉帳資訊</h6>
                            <p style="color: #777777"> 費用一共是 <%= price %> 請在取車時付款 </p>
                        </div>
                    </div>
                </div>

            </div>

        </div>
        <div style="width: 100%;margin: 10px;margin-top: 25px" class="form-check" >
            <input class="form-check-input" type="checkbox" value="" >
            <label style="color: #666666" class="form-check-label" for="flexCheckDefault">
                我已閱讀相關法規，且確定擁有中華民國駕駛執照
            </label>
        </div>
        <a style="margin-top: 10px;margin-bottom: 30px" class="btn btn-primary" onclick="send_order()">確認送出</a>
    </div>
</div>
<%- include('../components/footer.ejs') %>
<script>

    document.getElementById('payment').addEventListener('change', select_payment);


    function select_payment(){
        console
        console.log($('#payment').val())
        const payment_info = document.getElementById('payment_info')
        if($('#payment').val() === '1'){
            payment_info.innerHTML=`
                <div class="row">
                    <div class="col-md-6">
                        <h6 style="color: #666666;margin-top: 25px">轉帳資訊</h6>
                        <p style="color: #777777"> 郵局 (700)</p>
                    </div>
                    <div class="col-md-6">
                        <h6 style="color: #666666;margin-top: 25px">存款帳號</h6>
                        <p style="color: #777777">0184648 3745372</p>
                    </div>
                </div>
            `
        }
        if($('#payment').val() === '0'){
            payment_info.innerHTML=`
                <div class="row">
                    <div class="col-md-6">
                        <h6 style="color: #666666;margin-top: 25px">轉帳資訊</h6>
                        <p style="color: #777777"> 費用一共是 <%= price %> 請在取車時付款 </p>
                    </div>
                </div>
            `
        }
        if($('#payment').val() === '2'){
            payment_info.innerHTML=`
                <div class="row">
                    <div class="col-md-6">
                        <h6 style="color: #666666;margin-top: 25px">請點擊以下付款連結進行線上付款</h6>
                        <a style="background-color: #00B820;color: white;border: 0" class="btn btn-primary"> 線上付款</a>
                    </div>

                </div>
            `
        }
    }

    function send_order(){
        if("<%=classify%>"==='day'){
            axios.post('/order',{
                classify:'day',
                rental_time:'<%=std_rental_date%>',
                return_time:'<%=std_return_date%>',
                rental_point:"<%=rental_place.id%>",
                return_point:"<%=return_place.id%>",
                vehicle:"<%=vehicle.id%>",
                price:'<%=price%>',
                payment_method:$('#payment').val(),
            }).then(res=>{
                if(res.data.errno === 0){
                    swal({
                        'title':'下單成功',
                        'text':'正在跳轉至個人首頁',
                        'icon':'success',
                        'buttons':false,
                        'timer':1500
                    })
                    setTimeout(()=>{
                        location.href='/profile'
                    },1500)
                }
            })
        }else{
            axios.post('/order',{
                classify:'month',
                rental_time:'<%=std_rental_date%>',
                rental_point:"<%=rental_place.id%>",
                vehicle:"<%=vehicle.id%>",
                price:'<%=price%>',
                payment_method:$('#payment').val(),
            }).then(res=>{
                if(res.data.errno === 0){
                    swal({
                        'title':'下單成功',
                        'text':'正在跳轉至個人首頁',
                        'icon':'success',
                        'buttons':false,
                        'timer':1500
                    })
                    setTimeout(()=>{
                        location.href='/profile'
                    },1500)
                }
            })
        }
    }

</script>
